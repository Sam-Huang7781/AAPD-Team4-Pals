<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <title>homepage</title>
  </head>

  <body>
    <%- include('./layout/header'); -%>

    <section class="meditate-count bg-primary-dark position-relative">
      <!-- meditate-count 冥想倒數頁 倒數透明遮罩 -->
      <section
        class="position-absolute w-100 h-100 z-2 d-flex justify-content-center align-items-center"
        style="background: rgba(60, 60, 60, 0.8);"
        id="countdown-overlay"
      >
        <h2
          class="text-white mb-40"
          id="countdown-number"
          style="font-size: 128px"
        >
          3
        </h2>
      </section>

      <!-- meditate-programming 冥想進行頁 -->
      <div class="container pb-16">
        <div
          class="ui-top d-flex align-items-center justify-content-center gap-12 py-10"
        >
          <img
            src="/assets/images/meditateCount/Close_48.svg"
            alt="close icon"
            width="48"
          />
          <h3 class="fs-5 text-white">正念冥想</h3>
          <img
            src="/assets/images/meditateCount/voice_48.svg"
            alt="voice icon"
            width="48"
          />
        </div>

        <h4 class="meditate-instruction fs-5 text-white text-center">
          深吸氣，吐氣
        </h4>

        <div
          class="meditate-progress d-flex justify-content-center py-8 mb-3 position-relative"
        >
          <div id="progress-circle" style="width: 288px"></div>
          <!-- <img src="/assets/images/meditateCount/dolls-meditiating_Y.png"
            class="position-absolute top-50 start-50 translate-middle object-fit-none" alt="dolls_meditiating_Y" /> -->
          <img
            src="/assets/images/meditateCount/dolls-meditiating_Y.svg"
            class="position-absolute top-50 start-50 translate-middle z-1"
            alt="dolls_meditiating_Y"
          />
          <img
            src="/assets/images/meditateCount/aurora.png"
            class="position-absolute top-50 start-50 translate-middle"
            alt="aurora"
          />
        </div>

        <div class="text-text-tertiary text-center">
          <h4 class="fs-5">您已經冥想了</h4>
          <time
            datetime="00:00"
            class="d-block fs-10 fw-bold mx-6 my-2"
            id="countDown"
            style="letter-spacing: 4.8px"
            >00:00</time
          >
        </div>

        <div
          class="ui-bottom d-flex align-items-center justify-content-center gap-12 py-3"
        >
          <button type="button" class="btn p-0">
            <img
              src="/assets/images/meditateCount/back.svg"
              alt="backward icon"
            />
          </button>
          <button type="button" class="btn p-0">
            <img
              src="/assets/images/meditateCount/StopButton_80.svg"
              id="start-meditation"
              alt="play icon"
              width="80"
            />
          </button>
          <button type="button" class="btn p-0">
            <img
              src="/assets/images/meditateCount/forth.svg"
              alt="forward icon"
            />
          </button>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script type="module" src="../main.js"></script>
    <script type="module">
      import ProgressBar from 'progressbar.js/dist/progressbar.min.js';

      var bar = new ProgressBar.Circle("#progress-circle", {
        strokeWidth: 4,
        easing: "easeInOut",
        duration: 1400,
        color: "#ffcc00",
        trailColor: "#eee",
        trailWidth: 4,
        svgStyle: null,
      });

      // 更新進度
      bar.set(0);

      window.addEventListener("DOMContentLoaded", function () {
        const countdownNumber = document.getElementById("countdown-number");
        let count = 3;

        // 立即更新倒數數字並顯示倒數頁
        countdownNumber.textContent = count;

        // 每秒減少倒數
        var countdownInterval = setInterval(function () {
          count--;
          countdownNumber.textContent = count;

          if (count === 0) {
            clearInterval(countdownInterval);

            window.location.href = "./meditate-program.html";
          }
        }, 1000); // 每 1 秒執行一次
      });
    </script>
  </body>
</html>
